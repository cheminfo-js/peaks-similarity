!function(r,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.peaksSimilarity=n():r.peaksSimilarity=n()}(this,function(){return function(r){function n(e){if(t[e])return t[e].exports;var a=t[e]={exports:{},id:e,loaded:!1};return r[e].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}var t={};return n.m=r,n.c=t,n.p="",n(0)}([function(r,n,t){"use strict";function e(r,n,t){var e=[[],[]],a=0;t/=2;for(var o=0,i=r[0]?r[0].length:0,f=n[0]?n[0].length:0,u=0;i>u;u++){for(;f>a&&r[0][u]>n[0][a]+t;)a++;f>a&&r[0][u]>n[0][a]-t&&(e[0][o]=r[0][u],e[1][o]=r[1][u],o++)}return e}function a(r,n){var t,e,a,o,i=r[0][0],f=r[0][1],u=r[1][0],h=r[1][1],v=n[0][0],c=n[0][1],d=n[1][0],l=n[1][1];t=u-i,e=h-f,a=d-v,o=l-c;var s,g;return s=(-e*(i-v)+t*(f-c))/(-a*e+t*o),g=(a*(f-c)-o*(i-v))/(-a*e+t*o),s>=0&&1>=s&&g>=0&&1>=g?{x:i+g*t,y:f+g*e}:null}function o(r){var n=s.min(r[1]),t=s.max(r[1]),e=s.sum(r[1]),a=r[1]?r[1].length:0;if(0!=e)for(var o=0;a>o;o++)r[1][o]/=e;return{sum:e,min:n,max:t}}function i(r,n,t,a,i,u){if(!Array.isArray(r)||!Array.isArray(n))return{info:void 0,data:void 0};var h,v,l,s,g=f(r,a,i),y=f(n,a,i);return u&d?(h=e(g,y,t),l=o(h)):(h=g,l=o(h)),u&c?(v=e(y,g,t),s=o(v)):(v=y,s=o(v)),{info1:l,info2:s,data1:h,data2:v}}function f(r,n,t){for(var e=[[],[]],a=0,o=r[0]?r[0].length:0,i=0;o>i;i++)(!n||r[0][i]>=n)&&(!t||r[0][i]<=t)&&(e[0][a]=r[0][i],e[1][a]=r[1][i],a++);return e}function u(r,n,t){if(!Array.isArray(r))return{info:void 0,data:void 0};var e=f(r,n,t),a=o(e);return{info:a,data:e}}function h(r){if(0===r[1].length)return 0;for(var n=0,t=0;t<r[1].length;t++)n+=Math.abs(r[1][t]);return 1-n}var v=0,c=1,d=2,l=3,s=t(1).array;r.exports=function(r){function n(n){r=n||{},j="string"==typeof r.common?"first"===r.common.toLowerCase()?c:"second"===r.common.toLowerCase()?d:"both"===r.common.toLowerCase()?l:v:1==r.common?l:v,L=r.commonFactor||L||4,void 0==r.widthBottom&&(r.widthBottom=I||2),void 0==r.widthTop&&(r.widthTop=k||1),p(r.widthBottom,r.widthTop),A(r.from||z,r.to||D)}function t(r){if(O=E(r),j){var n=i(O,F,I,z,D,j);T=n.data1,B=n.info1,V=n.data2,N=n.info2}else{var t=u(O,z,D);T=t.data,B=t.info}}function s(r){if(F=E(r),j){var n=i(O,F,I,z,D,j);T=n.data1,B=n.info1,V=n.data2,N=n.info2}else{var t=u(F,z,D);V=t.data,N=t.info}}function g(){return T}function y(){return V}function m(){return B}function w(){return N}function p(r,n){if(k=n,I=r,C=(I-k)/2,k>I)throw"widthBottom has to be larger than widthTop"}function A(r,n){if(r!==z||n!==D)if(z=r,D=n,j){var t=i(O,F,I,z,D,j,L);T=t.data1,B=t.info1,V=t.data2,N=t.info2}else{var e=u(O,z,D);T=e.data,B=e.info;var e=u(F,z,D);V=e.data,N=e.info}}function M(r,n,t,e){if(0===n||0===e)return 0;var a=2*Math.abs(r-t);if(a>I)return 0;if(k>=a)return Math.min(n,e);var o=Math.max(n,e)*(I-a)/(I-k);return Math.min(n,e,o)}function x(r,n,t,e){var o=2/(k+I);if(0===n||0===e)return 0;if(r===t)return Math.min(n,e);var i=Math.abs(r-t);if(i>=I)return 0;if(n===e)return k>=i?((k+I)/2-i)*n*o:I>=i?(I-i)*n/2*(i-k)/(I-k)*o:0;var f=Math.min(n,e),u=Math.max(n,e),h=[[[0,0],[C,f]],[[C,f],[C+k,f]],[[k+C,f],[I,0]]];if(r>t&&n>e||t>r&&e>n)var v=[[i,0],[i+C,u]];else var v=[[i+C,u],[i,0]];for(var c=0;3>c;c++){var d=a(h[c],v);if(d)switch(c){case 0:return f-i*d.y/2*o;case 1:return(C*f/(2*u)*f+(k+C-d.x)*f+C*f/2)*o;case 2:return(I-i)*d.y/2*o}}return NaN}function q(){for(var n=[[].concat(T[0]),[].concat(T[1])],t=[[].concat(V[0]),[].concat(V[1])],e=T[0]?T[0].length:0,a=V[0]?V[0].length:0,o=0,i=0,f=0;e>o;){var u=n[0][o]-V[0][i];if(Math.abs(u)<I){if(r.trapezoid)var h=x(n[0][o],n[1][o],t[0][i],t[1][i],k,I);else var h=M(n[0][o],n[1][o],t[0][i],t[1][i],k,I);n[1][o]-=h,t[1][i]-=h,a-1>i?i++:(o++,i=f)}else u>0&&a-1>i?(i++,f=i):(o++,i=f)}return t}function E(r){if(Array.isArray(r)&&Array.isArray(r[0])&&2===r.length)return r;for(var n=new Array(r.length),t=new Array(r.length),e=0;e<r.length;e++)n[e]=r[e][0],t[e]=r[e][1];return[n,t]}function b(r,n){r&&t(r),n&&s(n);var e={};return e.diff=q(),e.extract1=g(),e.extract2=y(),e.extractInfo1=m(),e.extractInfo2=w(),e.similarity=h(e.diff),e}function S(r,n,t){T=f(O,n,t),V=r,j&d&&(T=e(T,V,I)),o(T);var a=q();return h(a)}var k,I,z,D,T,V,C,B,N,j,L;n(r);var O=[],F=[];this.setPeaks1=t,this.setPeaks2=s,this.getExtract1=g,this.getExtract2=y,this.getExtractInfo1=m,this.getExtractInfo2=w,this.setFromTo=A,this.setOptions=n,this.setTrapezoid=p,this.getSimilarity=b,this.getCommonArray=e,this.fastSimilarity=S}},function(r,n,t){"use strict";n.array=t(2),n.matrix=t(3)},function(r,n){"use strict";function t(r,n){return r-n}n.sum=function e(r){for(var e=0,n=0;n<r.length;n++)e+=r[n];return e},n.max=function a(r){for(var a=-(1/0),n=r.length,t=0;n>t;t++)r[t]>a&&(a=r[t]);return a},n.min=function o(r){for(var o=1/0,n=r.length,t=0;n>t;t++)r[t]<o&&(o=r[t]);return o},n.minMax=function(r){for(var n=1/0,t=-(1/0),e=r.length,a=0;e>a;a++)r[a]<n&&(n=r[a]),r[a]>t&&(t=r[a]);return{min:n,max:t}},n.arithmeticMean=function(r){for(var n=0,t=r.length,e=0;t>e;e++)n+=r[e];return n/t},n.mean=n.arithmeticMean,n.geometricMean=function(r){for(var n=1,t=r.length,e=0;t>e;e++)n*=r[e];return Math.pow(n,1/t)},n.logMean=function(r){for(var n=0,t=r.length,e=0;t>e;e++)n+=Math.log(r[e]);return n/t},n.grandMean=function(r,n){for(var t=0,e=0,a=r.length,o=0;a>o;o++)t+=n[o]*r[o],e+=n[o];return t/e},n.truncatedMean=function(r,n,e){void 0===e&&(e=!1),e||(r=r.slice().sort(t));for(var a=r.length,o=Math.floor(a*n),i=0,f=o;a-o>f;f++)i+=r[f];return i/(a-2*o)},n.harmonicMean=function(r){for(var n=0,t=r.length,e=0;t>e;e++){if(0===r[e])throw new RangeError("value at index "+e+"is zero");n+=1/r[e]}return t/n},n.contraHarmonicMean=function(r){for(var n=0,t=0,e=r.length,a=0;e>a;a++)n+=r[a]*r[a],t+=r[a];if(0>t)throw new RangeError("sum of values is negative");return n/t},n.median=function(r,n){void 0===n&&(n=!1),n||(r=r.slice().sort(t));var e=r.length,a=Math.floor(e/2);return e%2===0?.5*(r[a-1]+r[a]):r[a]},n.variance=function(r,t){void 0===t&&(t=!0);for(var e=n.mean(r),a=0,o=r.length,i=0;o>i;i++){var f=r[i]-e;a+=f*f}return t?a/(o-1):a/o},n.standardDeviation=function(r,t){return Math.sqrt(n.variance(r,t))},n.standardError=function(r){return n.standardDeviation(r)/Math.sqrt(r.length)},n.quartiles=function(r,e){"undefined"==typeof e&&(e=!1),e||(r=r.slice(),r.sort(t));var a=r.length/4,o=r[Math.ceil(a)-1],i=n.median(r,!0),f=r[Math.ceil(3*a)-1];return{q1:o,q2:i,q3:f}},n.pooledStandardDeviation=function(r,t){return Math.sqrt(n.pooledVariance(r,t))},n.pooledVariance=function(r,t){"undefined"==typeof t&&(t=!0);for(var e=0,a=0,o=r.length,i=0;o>i;i++){var f=r[i],u=n.variance(f);e+=(f.length-1)*u,a+=t?f.length-1:f.length}return e/a},n.mode=function(r){var n,t=r.length,e=new Array(t);for(n=0;t>n;n++)e[n]=0;var a=new Array(t),o=0;for(n=0;t>n;n++){var i=a.indexOf(r[n]);i>=0?e[i]++:(a[o]=r[n],e[o]=1,o++)}var f=0,u=0;for(n=0;o>n;n++)e[n]>f&&(f=e[n],u=n);return a[u]},n.covariance=function(r,t,e){"undefined"==typeof e&&(e=!0);var a=n.mean(r),o=n.mean(t);if(r.length!==t.length)throw"Vectors do not have the same dimensions";for(var i=0,f=r.length,u=0;f>u;u++){var h=r[u]-a,v=t[u]-o;i+=h*v}return e?i/(f-1):i/f},n.skewness=function(r,t){"undefined"==typeof t&&(t=!0);for(var e=n.mean(r),a=0,o=0,i=r.length,f=0;i>f;f++){var u=r[f]-e;a+=u*u,o+=u*u*u}var h=a/i,v=o/i,c=v/Math.pow(h,1.5);if(t){var d=Math.sqrt(i*(i-1)),l=i-2;return d/l*c}return c},n.kurtosis=function(r,t){"undefined"==typeof t&&(t=!0);for(var e=n.mean(r),a=r.length,o=0,i=0,f=0;a>f;f++){var u=r[f]-e;o+=u*u,i+=u*u*u*u}var h=o/a,v=i/a;if(t){var c=o/(a-1),d=a*(a+1)/((a-1)*(a-2)*(a-3)),l=i/(c*c),s=(a-1)*(a-1)/((a-2)*(a-3));return d*l-3*s}return v/(h*h)-3},n.entropy=function(r,n){"undefined"==typeof n&&(n=0);for(var t=0,e=r.length,a=0;e>a;a++)t+=r[a]*Math.log(r[a]+n);return-t},n.weightedMean=function(r,n){for(var t=0,e=r.length,a=0;e>a;a++)t+=r[a]*n[a];return t},n.weightedStandardDeviation=function(r,t){return Math.sqrt(n.weightedVariance(r,t))},n.weightedVariance=function(r,t){for(var e=n.weightedMean(r,t),a=0,o=r.length,i=0,f=0,u=0;o>u;u++){var h=r[u]-e,v=t[u];a+=v*(h*h),f+=v,i+=v*v}return a*(f/(f*f-i))},n.center=function(r,t){"undefined"==typeof t&&(t=!1);var e=r;t||(e=r.slice());for(var a=n.mean(e),o=e.length,i=0;o>i;i++)e[i]-=a},n.standardize=function(r,t,e){"undefined"==typeof t&&(t=n.standardDeviation(r)),"undefined"==typeof e&&(e=!1);for(var a=r.length,o=e?r:new Array(a),i=0;a>i;i++)o[i]=r[i]/t;return o},n.cumulativeSum=function(r){var n=r.length,t=new Array(n);t[0]=r[0];for(var e=1;n>e;e++)t[e]=t[e-1]+r[e];return t}},function(r,n,t){"use strict";function e(r,n){"undefined"==typeof n&&(n=0);for(var t=0,e=r.length,a=r[0].length,o=0;e>o;o++)for(var i=0;a>i;i++)t+=r[o][i]*Math.log(r[o][i]+n);return-t}function a(r,n){"undefined"==typeof n&&(n=0);var t,e,a,o,i=r.length,f=r[0].length;if(-1===n){for(t=[0],e=i*f,a=0;i>a;a++)for(o=0;f>o;o++)t[0]+=r[a][o];t[0]/=e}else if(0===n)for(t=new Array(f),e=i,o=0;f>o;o++){for(t[o]=0,a=0;i>a;a++)t[o]+=r[a][o];t[o]/=e}else{if(1!==n)throw new Error("Invalid dimension");for(t=new Array(i),e=f,o=0;i>o;o++){for(t[o]=0,a=0;f>a;a++)t[o]+=r[o][a];t[o]/=e}}return t}function o(r,n,t){for(var e=i(r,n,t),a=e.length,o=0;a>o;o++)e[o]=Math.sqrt(e[o]);return e}function i(r,n,t){"undefined"==typeof t&&(t=!0),n=n||a(r);var e=r.length;if(0===e)return[];for(var o=r[0].length,i=new Array(o),f=0;o>f;f++){for(var u=0,h=0,v=0,c=0;e>c;c++)v=r[c][f]-n[f],u+=v,h+=v*v;t?i[f]=(h-u*u/e)/(e-1):i[f]=(h-u*u/e)/e}return i}function f(r){for(var n=r.length,t=r[0].length,e=new Array(t),a=0;t>a;a++){for(var o=new Array(n),i=0;n>i;i++)o[i]=r[i][a];o.sort();var f=o.length;f%2===0?e[a]=.5*(o[f/2]+o[f/2-1]):e[a]=o[Math.floor(f/2)]}return e}function u(r){var n,t,e=r.length,a=r[0].length,o=new Array(a);for(n=0;a>n;n++){for(var i=new Array(e),f=0;e>f;f++)i[f]=0;var u=new Array(e),h=0;for(t=0;e>t;t++){var v=u.indexOf(r[t][n]);v>=0?i[v]++:(u[h]=r[t][n],i[h]=1,h++)}var c=0,d=0;for(t=0;h>t;t++)i[t]>c&&(c=i[t],d=t);o[n]=u[d]}return o}function h(r,n){"undefined"==typeof n&&(n=!0);for(var t=a(r),e=r.length,o=t.length,i=new Array(o),f=0;o>f;f++){for(var u=0,h=0,v=0;e>v;v++){var c=r[v][f]-t[f];u+=c*c,h+=c*c*c}var d=u/e,l=h/e,s=l/Math.pow(d,1.5);if(n){var g=Math.sqrt(e*(e-1)),y=e-2;i[f]=g/y*s}else i[f]=s}return i}function v(r,n){"undefined"==typeof n&&(n=!0);for(var t=a(r),e=r.length,o=r[0].length,i=new Array(o),f=0;o>f;f++){for(var u=0,h=0,v=0;e>v;v++){var c=r[v][f]-t[f];u+=c*c,h+=c*c*c*c}var d=u/e,l=h/e;if(n){var s=u/(e-1),g=e*(e+1)/((e-1)*(e-2)*(e-3)),y=h/(s*s),m=(e-1)*(e-1)/((e-2)*(e-3));i[f]=g*y-3*m}else i[f]=l/(d*d)-3}return i}function c(r){for(var n=r.length,t=o(r),e=t.length,a=new Array(e),i=Math.sqrt(n),f=0;e>f;f++)a[f]=t[f]/i;return a}function d(r,n){return l(r,void 0,n)}function l(r,n,t){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(0===t?n=r.length-1:1===t&&(n=r[0].length-1));var e=a(r,t),o=r.length;if(0===o)return[[]];var i,f,u,h,v,c=r[0].length;if(0===t){for(i=new Array(c),f=0;c>f;f++)i[f]=new Array(c);for(f=0;c>f;f++)for(u=f;c>u;u++){for(h=0,v=0;o>v;v++)h+=(r[v][u]-e[u])*(r[v][f]-e[f]);h/=n,i[f][u]=h,i[u][f]=h}}else{if(1!==t)throw new Error("Invalid dimension");for(i=new Array(o),f=0;o>f;f++)i[f]=new Array(o);for(f=0;o>f;f++)for(u=f;o>u;u++){for(h=0,v=0;c>v;v++)h+=(r[u][v]-e[u])*(r[f][v]-e[f]);h/=n,i[f][u]=h,i[u][f]=h}}return i}function s(r){var n,t,e=a(r),i=o(r,!0,e),f=g(r,e,i),u=r.length,h=r[0].length,v=new Array(h);for(n=0;h>n;n++)v[n]=new Array(h);for(n=0;h>n;n++)for(t=n;h>t;t++){for(var c=0,d=0,l=f.length;l>d;d++)c+=f[d][t]*f[d][n];c/=u-1,v[n][t]=c,v[t][n]=c}return v}function g(r,n,t){return n=n||a(r),"undefined"==typeof t&&(t=o(r,!0,n)),m(y(r,n,!1),t,!0)}function y(r,n,t){n=n||a(r);var e,o,i,f=r,u=r.length;if(!t)for(f=new Array(u),e=0;u>e;e++)f[e]=new Array(r[e].length);for(e=0;u>e;e++){var h=f[e];for(o=0,i=h.length;i>o;o++)h[o]=r[e][o]-n[o]}return f}function m(r,n,t){"undefined"==typeof n&&(n=o(r));var e,a,i,f=r,u=r.length;if(!t)for(f=new Array(u),e=0;u>e;e++)f[e]=new Array(r[e].length);for(e=0;u>e;e++){var h=f[e],v=r[e];for(a=0,i=h.length;i>a;a++)0===n[a]||isNaN(n[a])||(h[a]=v[a]/n[a])}return f}function w(r,n){var t=a(r),e=r.length;if(0===e)return[];for(var o=r[0].length,i=new Array(o),f=0;o>f;f++){for(var u=0,h=0,v=0,c=0;e>c;c++){var d=r[c][f]-t[f],l=n[c];u+=l*(d*d),v+=l,h+=l*l}i[f]=u*(v/(v*v-h))}return i}function p(r,n,t){"undefined"==typeof t&&(t=0);var e=r.length;if(0===e)return[];var a,o,i,f,u,h,v=r[0].length;if(0===t){for(a=new Array(v),o=0;v>o;o++)a[o]=0;for(o=0;e>o;o++)for(h=r[o],u=n[o],f=0;v>f;f++)a[f]+=h[f]*u}else{if(1!==t)throw new Error("Invalid dimension");for(a=new Array(e),o=0;e>o;o++)a[o]=0;for(f=0;e>f;f++)for(h=r[f],u=n[f],o=0;v>o;o++)a[f]+=h[o]*u}var c=x.sum(n);if(0!==c)for(o=0,i=a.length;i>o;o++)a[o]/=c;return a}function A(r,n,t,e){e=e||0,t=t||p(r,n,e);for(var a=0,o=0,i=0,f=n.length;f>i;i++)a+=n[i],o+=n[i]*n[i];var u=a/(a*a-o);return M(r,n,t,u,e)}function M(r,n,t,e,a){a=a||0,t=t||p(r,n,a),"undefined"==typeof e&&(e=1);var o=r.length;if(0===o)return[[]];var i,f,u,h,v,c=r[0].length;if(0===a){for(i=new Array(c),f=0;c>f;f++)i[f]=new Array(c);for(f=0;c>f;f++)for(u=f;c>u;u++){for(v=0,h=0;o>h;h++)v+=n[h]*(r[h][u]-t[u])*(r[h][f]-t[f]);i[f][u]=v*e,i[u][f]=v*e}}else{if(1!==a)throw new Error("Invalid dimension");for(i=new Array(o),f=0;o>f;f++)i[f]=new Array(o);for(f=0;o>f;f++)for(u=f;o>u;u++){for(v=0,h=0;c>h;h++)v+=n[h]*(r[u][h]-t[u])*(r[f][h]-t[f]);i[f][u]=v*e,i[u][f]=v*e}}return i}var x=t(2);r.exports={entropy:e,mean:a,standardDeviation:o,variance:i,median:f,mode:u,skewness:h,kurtosis:v,standardError:c,covariance:d,scatter:l,correlation:s,zScores:g,center:y,standardize:m,weightedVariance:w,weightedMean:p,weightedCovariance:A,weightedScatter:M}}])});
//# sourceMappingURL=peaks-similarity.min.js.map