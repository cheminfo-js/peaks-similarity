!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):"object"==typeof exports?exports.peaksSimilarity=r():t.peaksSimilarity=r()}(this,function(){return function(t){function r(a){if(n[a])return n[a].exports;var o=n[a]={exports:{},id:a,loaded:!1};return t[a].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var n={};return r.m=t,r.c=n,r.p="",r(0)}([function(t,r){"use strict";function n(t,r,n){var a=[],o=0;n/=2;for(var i=0,e=0;e<t.length;e++){for(;o<r.length&&t[e][0]>r[o][0]+n;)o++;o<r.length&&t[e][0]>r[o][0]-n&&(a[i++]=t[e])}return a}function a(t,r){var n,a,o,i,e=t[0][0],f=t[0][1],u=t[1][0],s=t[1][1],c=r[0][0],h=r[0][1],d=r[1][0],v=r[1][1];n=u-e,a=s-f,o=d-c,i=v-h;var m,l;return m=(-a*(e-c)+n*(f-h))/(-o*a+n*i),l=(o*(f-h)-i*(e-c))/(-o*a+n*i),m>=0&&1>=m&&l>=0&&1>=l?{x:e+l*n,y:f+l*a}:null}function o(t){for(var r=0,n=Number.MAX_VALUE,a=Number.MIN_VALUE,o=0;o<t.length;o++)r+=t[o][1],t[o][1]<n&&(n=t[o][1]),t[o][1]>a&&(a=t[o][1]);if(0!=r)for(var o=0;o<t.length;o++)t[o][1]/=r;return{sum:r,min:n,max:a}}function i(t,r,a,i,f,u){if(!Array.isArray(t)||!Array.isArray(r))return{info:void 0,data:void 0};var s,d,v,m,l=e(t,i,f),p=e(r,i,f);return u&h?(s=n(l,p,a),v=o(s)):(s=l,v=o(s)),u&c?(d=n(p,l,a),m=o(d)):(d=p,m=o(d)),{info1:v,info2:m,data1:s,data2:d}}function e(t,r,n){for(var a=[],o=0,i=0;i<t.length;i++)(!r||t[i][0]>=r)&&(!n||t[i][0]<=n)&&(a[o++]=[t[i][0],t[i][1]]);return a}function f(t,r,n){if(!Array.isArray(t))return{info:void 0,data:void 0};var a=e(t,r,n),i=o(a);return{info:i,data:a}}function u(t){for(var r=0,n=0;n<t.length;n++)r+=Math.abs(t[n][1]);return 1-r}const s=0,c=1,h=2,d=3;t.exports=function(t){function r(r){t=r||{},S="string"==typeof t.common?"first"===t.common.toLowerCase()?c:"second"===t.common.toLowerCase()?h:d:t.common?d:s,z=t.commonFactor||z||4,void 0==t.widthBottom&&(t.widthBottom=T||2),void 0==t.widthTop&&(t.widthTop=E||1),x(t.widthBottom,t.widthTop),y(t.from||I,t.to||N)}function o(t){if(F=M(t),S){var r=i(F,P,T,I,N,S);k=r.data1,j=r.info1,B=r.data2,C=r.info2}else{var n=f(F,I,N);k=n.data,j=n.info}}function e(t){if(P=M(t),S){var r=i(F,P,T,I,N,S);k=r.data1,j=r.info1,B=r.data2,C=r.info2}else{var n=f(P,I,N);B=n.data,C=n.info}}function v(){return k}function m(){return B}function l(){return j}function p(){return C}function x(t,r){if(E=r,T=t,L=(T-E)/2,E>T)throw"widthBottom has to be larger than widthTop"}function y(t,r){if(t!==I||r!==N)if(I=t,N=r,S){var n=i(F,P,T,I,N,S,z);k=n.data1,j=n.info1,B=n.data2,C=n.info2}else{var a=f(F,I,N);k=a.data,j=a.info;var a=f(P,I,N);B=a.data,C=a.info}}function g(t,r,n,a){if(0===r||0===a)return 0;var o=2*Math.abs(t-n);if(o>T)return 0;if(E>=o)return Math.min(r,a);var i=Math.max(r,a)*(T-o)/(T-E);return Math.min(r,a,i)}function A(t,r,n,o){var i=2/(E+T);if(0===r||0===o)return 0;if(t===n)return Math.min(r,o);var e=Math.abs(t-n);if(e>=T)return 0;if(r===o)return E>=e?((E+T)/2-e)*r*i:T>=e?(T-e)*r/2*(e-E)/(T-E)*i:0;var f=Math.min(r,o),u=Math.max(r,o),s=[[[0,0],[L,f]],[[L,f],[L+E,f]],[[E+L,f],[T,0]]];if(t>n&&r>o||n>t&&o>r)var c=[[e,0],[e+L,u]];else var c=[[e+L,u],[e,0]];for(var h=0;3>h;h++){var d=a(s[h],c);if(d)switch(h){case 0:return f-e*d.y/2*i;case 1:return(L*f/(2*u)*f+(E+L-d.x)*f+L*f/2)*i;case 2:return(T-e)*d.y/2*i}}return NaN}function w(){for(var r=[],n=0;n<B.length;n++)r.push([B[n][0],B[n][1]]);for(var a=[],n=0;n<k.length;n++)a.push([k[n][0],k[n][1]]);for(var o=0,i=0,e=0;o<a.length;){var f=a[o][0]-B[i][0];if(Math.abs(f)<T){if(t.trapezoid)var u=A(a[o][0],a[o][1],r[i][0],r[i][1],E,T);else var u=g(a[o][0],a[o][1],r[i][0],r[i][1],E,T);a[o][1]-=u,r[i][1]-=u,i<B.length-1?i++:(o++,i=e)}else f>0&&i<B.length-1?(i++,e=i):(o++,i=e)}return r}function M(t){if(Array.isArray(t)&&Array.isArray(t[0])&&2===t[0].length)return t;for(var r=t[0],n=t[1],a=[],o=0;o<r.length;o++)a.push([r[o],n[o]]);return a}function b(t,r){t&&o(t),r&&e(r);var n={};return n.diff=w(),n.extract1=v(),n.extract2=m(),n.extractInfo1=l(),n.extractInfo2=p(),n.similarity=u(n.diff),n}var E,T,I,N,k,B,L,j,C,S,z;r(t);var F=[],P=[];this.setPeaks1=o,this.setPeaks2=e,this.getExtract1=v,this.getExtract2=m,this.getExtractInfo1=l,this.getExtractInfo2=p,this.setFromTo=y,this.setOptions=r,this.setTrapezoid=x,this.getSimilarity=b,this.getCommonArray=n}}])});
//# sourceMappingURL=peaks-similarity.min.js.map