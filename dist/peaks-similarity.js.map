{"version":3,"sources":["webpack://peaksSimilarity/webpack/universalModuleDefinition","webpack://peaksSimilarity/webpack/bootstrap","webpack://peaksSimilarity/./node_modules/ml-stat/array.js","webpack://peaksSimilarity/./src/index.js","webpack://peaksSimilarity/./node_modules/ml-stat/index.js","webpack://peaksSimilarity/./node_modules/ml-stat/matrix.js"],"names":["compareNumbers","a","b","exports","sum","values","i","length","max","l","min","minMax","arithmeticMean","mean","geometricMean","mul","Math","pow","logMean","lnsum","log","grandMean","means","samples","n","truncatedMean","percent","alreadySorted","undefined","concat","sort","k","floor","harmonicMean","RangeError","contraHarmonicMean","r1","r2","median","half","variance","unbiased","theMean","theVariance","x","standardDeviation","sqrt","standardError","robustMeanAndStdev","y","stdev","averageDeviations","Array","abs","quartiles","quart","q1","ceil","q2","q3","pooledStandardDeviation","pooledVariance","vari","mode","itemCount","itemArray","count","index","indexOf","maxValue","maxIndex","covariance","vector1","vector2","mean1","mean2","cov","skewness","s2","s3","dev","m2","m3","g","kurtosis","s4","m4","v","c","entropy","eps","weightedMean","weights","weightedStandardDeviation","weightedVariance","z","w","center","inPlace","result","standardize","standardDev","cumulativeSum","array","COMMON_NO","COMMON_FIRST","COMMON_SECOND","COMMON_BOTH","Stat","require","module","Comparator","options","widthTop","widthBottom","from","to","array1Extract","array2Extract","widthSlope","array1ExtractInfo","array2ExtractInfo","common","commonFactor","setOptions","array1","array2","newOptions","toLowerCase","setTrapezoid","setFromTo","setPeaks1","anArray","checkArray","extracts","commonExtractAndNormalize","data1","info1","data2","info2","extract","extractAndNormalize","data","info","setPeaks2","getExtract1","getExtract2","getExtractInfo1","getExtractInfo2","newWidthBottom","newWidthTop","Error","newFrom","newTo","getOverlap","x1","y1","x2","y2","diff","getOverlapTrapezoid","factor","small","big","targets","segment","intersection","getIntersection","NaN","calculateDiff","newFirst","newSecond","array1Length","array2Length","pos1","pos2","previous2","overlap","trapezoid","points","isArray","getSimilarity","newPeaks1","newPeaks2","extract1","extract2","extractInfo1","extractInfo2","similarity","calculateOverlapFromDiff","fastSimilarity","getCommonArray","normalize","width","newArray","j","segment1","segment2","p0X","p0Y","p1X","p1Y","p2X","p2Y","p3X","p3Y","s1X","s1Y","s2X","s2Y","s","t","common1","common2","diffs","sumPos","matrix","arrayStat","Infinity","l1","l2","dimension","rows","cols","N","theSum","product","theProduct","sum1","sum2","medians","modes","skew","m","kurt","standardDeviations","standardErrors","sqrtN","scatter","divisor","correlation","scores","zScores","cor","jj","row","resultRow","sourceRow","isNaN","ii","weightSum","weightedCovariance","s1","weightedScatter"],"mappings":"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","file":"peaks-similarity.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"peaksSimilarity\"] = factory();\n\telse\n\t\troot[\"peaksSimilarity\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","'use strict';\n\nfunction compareNumbers(a, b) {\n    return a - b;\n}\n\n/**\n * Computes the sum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.sum = function sum(values) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n        sum += values[i];\n    }\n    return sum;\n};\n\n/**\n * Computes the maximum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.max = function max(values) {\n    var max = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] > max) max = values[i];\n    }\n    return max;\n};\n\n/**\n * Computes the minimum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.min = function min(values) {\n    var min = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] < min) min = values[i];\n    }\n    return min;\n};\n\n/**\n * Computes the min and max of the given values\n * @param {Array} values\n * @returns {{min: number, max: number}}\n */\nexports.minMax = function minMax(values) {\n    var min = values[0];\n    var max = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] < min) min = values[i];\n        if (values[i] > max) max = values[i];\n    }\n    return {\n        min: min,\n        max: max\n    };\n};\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.arithmeticMean = function arithmeticMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        sum += values[i];\n    }\n    return sum / l;\n};\n\n/**\n * {@link arithmeticMean}\n */\nexports.mean = exports.arithmeticMean;\n\n/**\n * Computes the geometric mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.geometricMean = function geometricMean(values) {\n    var mul = 1;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        mul *= values[i];\n    }\n    return Math.pow(mul, 1 / l);\n};\n\n/**\n * Computes the mean of the log of the given values\n * If the return value is exponentiated, it gives the same result as the\n * geometric mean.\n * @param {Array} values\n * @returns {number}\n */\nexports.logMean = function logMean(values) {\n    var lnsum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        lnsum += Math.log(values[i]);\n    }\n    return lnsum / l;\n};\n\n/**\n * Computes the weighted grand mean for a list of means and sample sizes\n * @param {Array} means - Mean values for each set of samples\n * @param {Array} samples - Number of original values for each set of samples\n * @returns {number}\n */\nexports.grandMean = function grandMean(means, samples) {\n    var sum = 0;\n    var n = 0;\n    var l = means.length;\n    for (var i = 0; i < l; i++) {\n        sum += samples[i] * means[i];\n        n += samples[i];\n    }\n    return sum / n;\n};\n\n/**\n * Computes the truncated mean of the given values using a given percentage\n * @param {Array} values\n * @param {number} percent - The percentage of values to keep (range: [0,1])\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.truncatedMean = function truncatedMean(values, percent, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n    var l = values.length;\n    var k = Math.floor(l * percent);\n    var sum = 0;\n    for (var i = k; i < (l - k); i++) {\n        sum += values[i];\n    }\n    return sum / (l - 2 * k);\n};\n\n/**\n * Computes the harmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.harmonicMean = function harmonicMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        if (values[i] === 0) {\n            throw new RangeError('value at index ' + i + 'is zero');\n        }\n        sum += 1 / values[i];\n    }\n    return l / sum;\n};\n\n/**\n * Computes the contraharmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.contraHarmonicMean = function contraHarmonicMean(values) {\n    var r1 = 0;\n    var r2 = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        r1 += values[i] * values[i];\n        r2 += values[i];\n    }\n    if (r2 < 0) {\n        throw new RangeError('sum of values is negative');\n    }\n    return r1 / r2;\n};\n\n/**\n * Computes the median of the given values\n * @param {Array} values\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.median = function median(values, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n    var l = values.length;\n    var half = Math.floor(l / 2);\n    if (l % 2 === 0) {\n        return (values[half - 1] + values[half]) * 0.5;\n    } else {\n        return values[half];\n    }\n};\n\n/**\n * Computes the variance of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.variance = function variance(values, unbiased) {\n    if (unbiased === undefined) unbiased = true;\n    var theMean = exports.mean(values);\n    var theVariance = 0;\n    var l = values.length;\n\n    for (var i = 0; i < l; i++) {\n        var x = values[i] - theMean;\n        theVariance += x * x;\n    }\n\n    if (unbiased) {\n        return theVariance / (l - 1);\n    } else {\n        return theVariance / l;\n    }\n};\n\n/**\n * Computes the standard deviation of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.standardDeviation = function standardDeviation(values, unbiased) {\n    return Math.sqrt(exports.variance(values, unbiased));\n};\n\nexports.standardError = function standardError(values) {\n    return exports.standardDeviation(values) / Math.sqrt(values.length);\n};\n\n/**\n * IEEE Transactions on biomedical engineering, vol. 52, no. 1, january 2005, p. 76-\n * Calculate the standard deviation via the Median of the absolute deviation\n *  The formula for the standard deviation only holds for Gaussian random variables.\n * @returns {{mean: number, stdev: number}}\n */\nexports.robustMeanAndStdev = function robustMeanAndStdev(y) {\n    var mean = 0, stdev = 0;\n    var length = y.length, i = 0;\n    for (i = 0; i < length; i++) {\n        mean += y[i];\n    }\n    mean /= length;\n    var averageDeviations = new Array(length);\n    for (i = 0; i < length; i++)\n        averageDeviations[i] = Math.abs(y[i] - mean);\n    averageDeviations.sort(compareNumbers);\n    if (length % 2 === 1) {\n        stdev = averageDeviations[(length - 1) / 2] / 0.6745;\n    } else {\n        stdev = 0.5 * (averageDeviations[length / 2] + averageDeviations[length / 2 - 1]) / 0.6745;\n    }\n\n    return {\n        mean: mean,\n        stdev: stdev\n    };\n};\n\nexports.quartiles = function quartiles(values, alreadySorted) {\n    if (typeof (alreadySorted) === 'undefined') alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n\n    var quart = values.length / 4;\n    var q1 = values[Math.ceil(quart) - 1];\n    var q2 = exports.median(values, true);\n    var q3 = values[Math.ceil(quart * 3) - 1];\n\n    return {q1: q1, q2: q2, q3: q3};\n};\n\nexports.pooledStandardDeviation = function pooledStandardDeviation(samples, unbiased) {\n    return Math.sqrt(exports.pooledVariance(samples, unbiased));\n};\n\nexports.pooledVariance = function pooledVariance(samples, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var sum = 0;\n    var length = 0, l = samples.length;\n    for (var i = 0; i < l; i++) {\n        var values = samples[i];\n        var vari = exports.variance(values);\n\n        sum += (values.length - 1) * vari;\n\n        if (unbiased)\n            length += values.length - 1;\n        else\n            length += values.length;\n    }\n    return sum / length;\n};\n\nexports.mode = function mode(values) {\n    var l = values.length,\n        itemCount = new Array(l),\n        i;\n    for (i = 0; i < l; i++) {\n        itemCount[i] = 0;\n    }\n    var itemArray = new Array(l);\n    var count = 0;\n\n    for (i = 0; i < l; i++) {\n        var index = itemArray.indexOf(values[i]);\n        if (index >= 0)\n            itemCount[index]++;\n        else {\n            itemArray[count] = values[i];\n            itemCount[count] = 1;\n            count++;\n        }\n    }\n\n    var maxValue = 0, maxIndex = 0;\n    for (i = 0; i < count; i++) {\n        if (itemCount[i] > maxValue) {\n            maxValue = itemCount[i];\n            maxIndex = i;\n        }\n    }\n\n    return itemArray[maxIndex];\n};\n\nexports.covariance = function covariance(vector1, vector2, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var mean1 = exports.mean(vector1);\n    var mean2 = exports.mean(vector2);\n\n    if (vector1.length !== vector2.length)\n        throw 'Vectors do not have the same dimensions';\n\n    var cov = 0, l = vector1.length;\n    for (var i = 0; i < l; i++) {\n        var x = vector1[i] - mean1;\n        var y = vector2[i] - mean2;\n        cov += x * y;\n    }\n\n    if (unbiased)\n        return cov / (l - 1);\n    else\n        return cov / l;\n};\n\nexports.skewness = function skewness(values, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n\n    var s2 = 0, s3 = 0, l = values.length;\n    for (var i = 0; i < l; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s3 += dev * dev * dev;\n    }\n    var m2 = s2 / l;\n    var m3 = s3 / l;\n\n    var g = m3 / (Math.pow(m2, 3 / 2.0));\n    if (unbiased) {\n        var a = Math.sqrt(l * (l - 1));\n        var b = l - 2;\n        return (a / b) * g;\n    } else {\n        return g;\n    }\n};\n\nexports.kurtosis = function kurtosis(values, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n    var n = values.length, s2 = 0, s4 = 0;\n\n    for (var i = 0; i < n; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s4 += dev * dev * dev * dev;\n    }\n    var m2 = s2 / n;\n    var m4 = s4 / n;\n\n    if (unbiased) {\n        var v = s2 / (n - 1);\n        var a = (n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3));\n        var b = s4 / (v * v);\n        var c = ((n - 1) * (n - 1)) / ((n - 2) * (n - 3));\n\n        return a * b - 3 * c;\n    } else {\n        return m4 / (m2 * m2) - 3;\n    }\n};\n\nexports.entropy = function entropy(values, eps) {\n    if (typeof (eps) === 'undefined') eps = 0;\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * Math.log(values[i] + eps);\n    return -sum;\n};\n\nexports.weightedMean = function weightedMean(values, weights) {\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * weights[i];\n    return sum;\n};\n\nexports.weightedStandardDeviation = function weightedStandardDeviation(values, weights) {\n    return Math.sqrt(exports.weightedVariance(values, weights));\n};\n\nexports.weightedVariance = function weightedVariance(values, weights) {\n    var theMean = exports.weightedMean(values, weights);\n    var vari = 0, l = values.length;\n    var a = 0, b = 0;\n\n    for (var i = 0; i < l; i++) {\n        var z = values[i] - theMean;\n        var w = weights[i];\n\n        vari += w * (z * z);\n        b += w;\n        a += w * w;\n    }\n\n    return vari * (b / (b * b - a));\n};\n\nexports.center = function center(values, inPlace) {\n    if (typeof (inPlace) === 'undefined') inPlace = false;\n\n    var result = values;\n    if (!inPlace)\n        result = [].concat(values);\n\n    var theMean = exports.mean(result), l = result.length;\n    for (var i = 0; i < l; i++)\n        result[i] -= theMean;\n};\n\nexports.standardize = function standardize(values, standardDev, inPlace) {\n    if (typeof (standardDev) === 'undefined') standardDev = exports.standardDeviation(values);\n    if (typeof (inPlace) === 'undefined') inPlace = false;\n    var l = values.length;\n    var result = inPlace ? values : new Array(l);\n    for (var i = 0; i < l; i++)\n        result[i] = values[i] / standardDev;\n    return result;\n};\n\nexports.cumulativeSum = function cumulativeSum(array) {\n    var l = array.length;\n    var result = new Array(l);\n    result[0] = array[0];\n    for (var i = 1; i < l; i++)\n        result[i] = result[i - 1] + array[i];\n    return result;\n};\n","'use strict';\n\nvar COMMON_NO = 0;\nvar COMMON_FIRST = 1;\nvar COMMON_SECOND = 2;\nvar COMMON_BOTH = 3; // should be a binary operation !\n\nvar Stat = require('ml-stat').array;\n\n/**\n * Create a comparator class\n * {object} [options={}]\n * {string} [options.common=''] should we take only common peaks 'first', 'second', 'both', ''\n * {number} [options.widthBottom=2] bottom trapezoid width for similarity evaluation\n * {number} [options.widthTop=1] top trapezoid width for similarity evaluation\n * {number} [options.from] from region used for similarity calculation\n * {number} [options.to] to region used for similarity calculation\n */\n\nmodule.exports = function Comparator(options = {}) {\n  var widthTop, widthBottom, from, to;\n  var array1Extract, array2Extract, widthSlope, array1ExtractInfo, array2ExtractInfo;\n  var common, commonFactor;\n\n  setOptions(options);\n\n  var array1 = [];\n  var array2 = [];\n\n  /*\n     2 formats are allowed:\n     [[x1,x2,...],[y1,y2,...]] or [[x1,y1],[x2,y2], ...]\n    */\n\n  function setOptions(newOptions) {\n    options = newOptions || {};\n    if (typeof options.common === 'string') {\n      if (options.common.toLowerCase() === 'first') {\n        common = COMMON_FIRST;\n      } else if (options.common.toLowerCase() === 'second') {\n        common = COMMON_SECOND;\n      } else if (options.common.toLowerCase() === 'both') {\n        common = COMMON_BOTH;\n      } else {\n        common = COMMON_NO;\n      }\n    } else {\n      if (options.common === true) {\n        common = COMMON_BOTH;\n      } else {\n        common = COMMON_NO;\n      }\n    }\n    commonFactor = options.commonFactor || commonFactor || 4;\n\n    if (options.widthBottom === undefined) {\n      options.widthBottom = widthBottom || 2;\n    }\n    if (options.widthTop === undefined) {\n      options.widthTop = widthTop || 1;\n    }\n    setTrapezoid(options.widthBottom, options.widthTop);\n    setFromTo(options.from || from, options.to || to);\n  }\n\n  function setPeaks1(anArray) {\n    array1 = checkArray(anArray);\n\n    if (common) {\n      var extracts = commonExtractAndNormalize(array1, array2, widthBottom, from, to, common);\n      array1Extract = extracts.data1;\n      array1ExtractInfo = extracts.info1;\n      array2Extract = extracts.data2;\n      array2ExtractInfo = extracts.info2;\n    } else {\n      var extract = extractAndNormalize(array1, from, to);\n      array1Extract = extract.data;\n      array1ExtractInfo = extract.info;\n    }\n  }\n  function setPeaks2(anArray) {\n    array2 = checkArray(anArray);\n    if (common) {\n      var extracts = commonExtractAndNormalize(array1, array2, widthBottom, from, to, common);\n      array1Extract = extracts.data1;\n      array1ExtractInfo = extracts.info1;\n      array2Extract = extracts.data2;\n      array2ExtractInfo = extracts.info2;\n    } else {\n      var extract = extractAndNormalize(array2, from, to);\n      array2Extract = extract.data;\n      array2ExtractInfo = extract.info;\n    }\n  }\n\n  function getExtract1() {\n    return array1Extract;\n  }\n\n  function getExtract2() {\n    return array2Extract;\n  }\n\n\n  function getExtractInfo1() {\n    return array1ExtractInfo;\n  }\n\n  function getExtractInfo2() {\n    return array2ExtractInfo;\n  }\n\n  function setTrapezoid(newWidthBottom, newWidthTop) {\n    widthTop = newWidthTop;\n    widthBottom = newWidthBottom;\n    widthSlope = (widthBottom - widthTop) / 2;\n    if (widthBottom < widthTop) throw new Error('widthBottom has to be larger than widthTop');\n  }\n\n  function setFromTo(newFrom, newTo) {\n    if (newFrom === from && newTo === to) return;\n    from = newFrom;\n    to = newTo;\n    if (common) {\n      var extracts = commonExtractAndNormalize(array1, array2, widthBottom, from, to, common, commonFactor);\n      array1Extract = extracts.data1;\n      array1ExtractInfo = extracts.info1;\n      array2Extract = extracts.data2;\n      array2ExtractInfo = extracts.info2;\n    } else {\n      var extract = extractAndNormalize(array1, from, to);\n      array1Extract = extract.data;\n      array1ExtractInfo = extract.info;\n      extract = extractAndNormalize(array2, from, to);\n      array2Extract = extract.data;\n      array2ExtractInfo = extract.info;\n    }\n  }\n\n\n  function getOverlap(x1, y1, x2, y2) {\n    if (y1 === 0 || y2 === 0) return 0;\n\n    // TAKE CARE !!! We multiply the diff by 2 !!!\n    var diff = Math.abs(x1 - x2) * 2;\n\n    if (diff > widthBottom) return 0;\n    if (diff <= widthTop) {\n      return Math.min(y1, y2);\n    }\n\n    var maxValue = Math.max(y1, y2) * (widthBottom - diff) / (widthBottom - widthTop);\n    return Math.min(y1, y2, maxValue);\n  }\n\n  // This is the old trapezoid similarity\n  function getOverlapTrapezoid(x1, y1, x2, y2) {\n    var factor = 2 / (widthTop + widthBottom); // correction for surface=1\n    if (y1 === 0 || y2 === 0) return 0;\n    if (x1 === x2) { // they have the same position\n      return Math.min(y1, y2);\n    }\n\n    var diff = Math.abs(x1 - x2);\n    if (diff >= widthBottom) return 0;\n    if (y1 === y2) { // do they have the same height ???\n      // we need to find the common length\n      if (diff <= widthTop) {\n        return (((widthTop + widthBottom) / 2 - diff) * y1) * factor;\n      } else if (diff <= widthBottom) {\n        return (widthBottom - diff) * y1 / 2 * (diff - widthTop) / (widthBottom - widthTop) * factor;\n      }\n      return 0;\n    } else { // the height are different and not the same position ...\n      // we need to consider only one segment to find its intersection\n\n      var small = Math.min(y1, y2);\n      var big = Math.max(y1, y2);\n\n      var targets = [\n        [[0, 0], [widthSlope, small]],\n        [[widthSlope, small], [widthSlope + widthTop, small]],\n        [[widthTop + widthSlope, small], [widthBottom, 0]]\n      ];\n      var segment;\n      if ((x1 > x2 && y1 > y2) || (x1 < x2 && y1 < y2)) {\n        segment = [[diff, 0], [diff + widthSlope, big]];\n      } else {\n        segment = [[diff + widthSlope, big], [diff, 0]];\n      }\n\n\n      for (var i = 0; i < 3; i++) {\n        var intersection = getIntersection(targets[i], segment);\n        if (intersection) {\n          switch (i) {\n            case 0:\n              return small - ((diff * intersection.y / 2)) * factor;\n            case 1: // to simplify ...\n              //     console.log(\"           \",widthSlope,small,big,intersection.x)\n              return ((widthSlope * small / (2 * big)) * small +\n                                (widthTop + widthSlope - intersection.x) * small +\n                                widthSlope * small / 2) * factor;\n            case 2:\n              return ((widthBottom - diff) * intersection.y / 2) * factor;\n            default:\n              throw new Error(`unexpected intersection value: ${i}`);\n          }\n        }\n      }\n    }\n    return NaN;\n  }\n\n\n  // this method calculates the total diff. The sum of positive value will yield to overlap\n  function calculateDiff() {\n    // we need to take 2 pointers\n    // and travel progressively between them ...\n    var newFirst = [\n      [].concat(array1Extract[0]),\n      [].concat(array1Extract[1])\n    ];\n    var newSecond = [\n      [].concat(array2Extract[0]),\n      [].concat(array2Extract[1])\n    ];\n    var array1Length = array1Extract[0] ? array1Extract[0].length : 0;\n    var array2Length = array2Extract[0] ? array2Extract[0].length : 0;\n\n    var pos1 = 0;\n    var pos2 = 0;\n    var previous2 = 0;\n    while (pos1 < array1Length) {\n      var diff = newFirst[0][pos1] - array2Extract[0][pos2];\n      if (Math.abs(diff) < widthBottom) { // there is some overlap\n        var overlap;\n        if (options.trapezoid) {\n          overlap = getOverlapTrapezoid(newFirst[0][pos1], newFirst[1][pos1], newSecond[0][pos2], newSecond[1][pos2], widthTop, widthBottom);\n        } else {\n          overlap = getOverlap(newFirst[0][pos1], newFirst[1][pos1], newSecond[0][pos2], newSecond[1][pos2], widthTop, widthBottom);\n        }\n        newFirst[1][pos1] -= overlap;\n        newSecond[1][pos2] -= overlap;\n        if (pos2 < (array2Length - 1)) {\n          pos2++;\n        } else {\n          pos1++;\n          pos2 = previous2;\n        }\n      } else {\n        if (diff > 0 && pos2 < (array2Length - 1)) {\n          pos2++;\n          previous2 = pos2;\n        } else {\n          pos1++;\n          pos2 = previous2;\n        }\n      }\n    }\n    return newSecond;\n  }\n\n\n  /*\n        This code requires the use of an array like  [[x1,y1],[x2,y2], ...]\n        If it is not the right format, we will just convert it\n        Otherwise we return the correct format\n     */\n  function checkArray(points) {\n    // if it is already a 2D array of points, we just return them\n    if (Array.isArray(points) && Array.isArray(points[0]) && points.length === 2) return points;\n    var x = new Array(points.length);\n    var y = new Array(points.length);\n    for (var i = 0; i < points.length; i++) {\n      x[i] = points[i][0];\n      y[i] = points[i][1];\n    }\n    return [x, y];\n  }\n\n  function getSimilarity(newPeaks1, newPeaks2) {\n    if (newPeaks1) setPeaks1(newPeaks1);\n    if (newPeaks2) setPeaks2(newPeaks2);\n    var result = {};\n    result.diff = calculateDiff();\n    result.extract1 = getExtract1();\n    result.extract2 = getExtract2();\n    result.extractInfo1 = getExtractInfo1();\n    result.extractInfo2 = getExtractInfo2();\n    result.similarity = calculateOverlapFromDiff(result.diff);\n    result.widthBottom = widthBottom;\n    result.widthTop = widthTop;\n    return result;\n  }\n\n  /*\n    This works mainly when you have a array1 that is fixed\n    newPeaks2 have to be normalized ! (sum to 1)\n  */\n  function fastSimilarity(newPeaks2, from, to) {\n    array1Extract = extract(array1, from, to);\n    array2Extract = newPeaks2;\n    if (common & COMMON_SECOND) array1Extract = getCommonArray(array1Extract, array2Extract, widthBottom);\n    normalize(array1Extract);\n    var diff = calculateDiff();\n    return calculateOverlapFromDiff(diff);\n  }\n\n\n  this.setPeaks1 = setPeaks1;\n  this.setPeaks2 = setPeaks2;\n  this.getExtract1 = getExtract1;\n  this.getExtract2 = getExtract2;\n  this.getExtractInfo1 = getExtractInfo1;\n  this.getExtractInfo2 = getExtractInfo2;\n  this.setFromTo = setFromTo;\n  this.setOptions = setOptions;\n  this.setTrapezoid = setTrapezoid;\n  this.getSimilarity = getSimilarity;\n  this.getCommonArray = getCommonArray;\n\n  this.fastSimilarity = fastSimilarity;\n};\n\n\n// returns an new array based on array1 where there is a peak of array2 at a distance under width/2\nfunction getCommonArray(array1, array2, width) {\n  var newArray = [[], []];\n  var pos2 = 0;\n  width /= 2;\n  var j = 0;\n  var array1Length = array1[0] ? array1[0].length : 0;\n  var array2Length = array2[0] ? array2[0].length : 0;\n\n  for (var i = 0; i < array1Length; i++) {\n    while (pos2 < array2Length && (array1[0][i] > (array2[0][pos2] + width))) {\n      pos2++;\n    }\n    if ((pos2 < array2Length) && (array1[0][i] > array2[0][pos2] - width)) {\n      newArray[0][j] = array1[0][i];\n      newArray[1][j] = array1[1][i];\n      j++;\n    }\n  }\n  return newArray;\n}\n\n\n// Adapted from: http://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect/1968345#1968345\nfunction getIntersection(segment1, segment2) {\n  var p0X = segment1[0][0];\n  var p0Y = segment1[0][1];\n  var p1X = segment1[1][0];\n  var p1Y = segment1[1][1];\n  var p2X = segment2[0][0];\n  var p2Y = segment2[0][1];\n  var p3X = segment2[1][0];\n  var p3Y = segment2[1][1];\n\n  var s1X, s1Y, s2X, s2Y;\n  s1X = p1X - p0X;\n  s1Y = p1Y - p0Y;\n  s2X = p3X - p2X;\n  s2Y = p3Y - p2Y;\n  var s, t;\n  s = (-s1Y * (p0X - p2X) + s1X * (p0Y - p2Y)) / (-s2X * s1Y + s1X * s2Y);\n  t = (s2X * (p0Y - p2Y) - s2Y * (p0X - p2X)) / (-s2X * s1Y + s1X * s2Y);\n  if (s >= 0 && s <= 1 && t >= 0 && t <= 1) {\n    return {\n      x: p0X + (t * s1X),\n      y: p0Y + (t * s1Y)\n    };\n  }\n  return null; // No collision\n}\n\nfunction normalize(array) {\n  var min = Stat.min(array[1]);\n  var max = Stat.max(array[1]);\n  var sum = Stat.sum(array[1]);\n  var length = array[1] ? array[1].length : 0;\n  if (sum !== 0) {\n    for (var i = 0; i < length; i++) {\n      array[1][i] /= sum;\n    }\n  }\n  return {\n    sum: sum,\n    min: min,\n    max: max\n  };\n}\n\n// this method will systematically take care of both array\nfunction commonExtractAndNormalize(array1, array2, width, from, to, common) {\n  if (!(Array.isArray(array1)) || !(Array.isArray(array2))) {\n    return {\n      info: undefined,\n      data: undefined\n    };\n  }\n  var extract1 = extract(array1, from, to);\n  var extract2 = extract(array2, from, to);\n  var common1, common2, info1, info2;\n  if (common & COMMON_SECOND) {\n    common1 = getCommonArray(extract1, extract2, width);\n    info1 = normalize(common1);\n  } else {\n    common1 = extract1;\n    info1 = normalize(common1);\n  }\n  if (common & COMMON_FIRST) {\n    common2 = getCommonArray(extract2, extract1, width);\n    info2 = normalize(common2);\n  } else {\n    common2 = extract2;\n    info2 = normalize(common2);\n  }\n\n  return {\n    info1: info1,\n    info2: info2,\n    data1: common1,\n    data2: common2\n  };\n}\n\nfunction extract(array, from, to) {\n  var newArray = [[], []];\n  var j = 0;\n  var length = array[0] ? array[0].length : 0;\n  for (var i = 0; i < length; i++) {\n    if ((!from || array[0][i] >= from) && (!to || array[0][i] <= to)) {\n      newArray[0][j] = array[0][i];\n      newArray[1][j] = array[1][i];\n      j++;\n    }\n  }\n  return newArray;\n}\n\nfunction extractAndNormalize(array, from, to) {\n  if (!(Array.isArray(array))) {\n    return {\n      info: undefined,\n      data: undefined\n    };\n  }\n  var newArray = extract(array, from, to);\n  var info = normalize(newArray);\n  return {\n    info: info,\n    data: newArray\n  };\n}\n\nfunction calculateOverlapFromDiff(diffs) {\n  if (diffs[1].length === 0) return 0;\n  var sumPos = 0;\n  for (var i = 0; i < diffs[1].length; i++) {\n    sumPos += Math.abs(diffs[1][i]);\n  }\n  return 1 - sumPos;\n}\n","'use strict';\n\nexports.array = require('./array');\nexports.matrix = require('./matrix');\n","'use strict';\n\nvar arrayStat = require('./array');\n\nfunction compareNumbers(a, b) {\n    return a - b;\n}\n\nexports.max = function max(matrix) {\n    var max = -Infinity;\n    for (var i = 0; i < matrix.length; i++) {\n        for (var j = 0; j < matrix[i].length; j++) {\n            if (matrix[i][j] > max) max = matrix[i][j];\n        }\n    }\n    return max;\n};\n\nexports.min = function min(matrix) {\n    var min = Infinity;\n    for (var i = 0; i < matrix.length; i++) {\n        for (var j = 0; j < matrix[i].length; j++) {\n            if (matrix[i][j] < min) min = matrix[i][j];\n        }\n    }\n    return min;\n};\n\nexports.minMax = function minMax(matrix) {\n    var min = Infinity;\n    var max = -Infinity;\n    for (var i = 0; i < matrix.length; i++) {\n        for (var j = 0; j < matrix[i].length; j++) {\n            if (matrix[i][j] < min) min = matrix[i][j];\n            if (matrix[i][j] > max) max = matrix[i][j];\n        }\n    }\n    return {\n        min:min,\n        max:max\n    };\n};\n\nexports.entropy = function entropy(matrix, eps) {\n    if (typeof (eps) === 'undefined') {\n        eps = 0;\n    }\n    var sum = 0,\n        l1 = matrix.length,\n        l2 = matrix[0].length;\n    for (var i = 0; i < l1; i++) {\n        for (var j = 0; j < l2; j++) {\n            sum += matrix[i][j] * Math.log(matrix[i][j] + eps);\n        }\n    }\n    return -sum;\n};\n\nexports.mean = function mean(matrix, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theMean, N, i, j;\n\n    if (dimension === -1) {\n        theMean = [0];\n        N = rows * cols;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theMean[0] += matrix[i][j];\n            }\n        }\n        theMean[0] /= N;\n    } else if (dimension === 0) {\n        theMean = new Array(cols);\n        N = rows;\n        for (j = 0; j < cols; j++) {\n            theMean[j] = 0;\n            for (i = 0; i < rows; i++) {\n                theMean[j] += matrix[i][j];\n            }\n            theMean[j] /= N;\n        }\n    } else if (dimension === 1) {\n        theMean = new Array(rows);\n        N = cols;\n        for (j = 0; j < rows; j++) {\n            theMean[j] = 0;\n            for (i = 0; i < cols; i++) {\n                theMean[j] += matrix[j][i];\n            }\n            theMean[j] /= N;\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theMean;\n};\n\nexports.sum = function sum(matrix, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theSum, i, j;\n\n    if (dimension === -1) {\n        theSum = [0];\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theSum[0] += matrix[i][j];\n            }\n        }\n    } else if (dimension === 0) {\n        theSum = new Array(cols);\n        for (j = 0; j < cols; j++) {\n            theSum[j] = 0;\n            for (i = 0; i < rows; i++) {\n                theSum[j] += matrix[i][j];\n            }\n        }\n    } else if (dimension === 1) {\n        theSum = new Array(rows);\n        for (j = 0; j < rows; j++) {\n            theSum[j] = 0;\n            for (i = 0; i < cols; i++) {\n                theSum[j] += matrix[j][i];\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theSum;\n};\n\nexports.product = function product(matrix, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        theProduct, i, j;\n\n    if (dimension === -1) {\n        theProduct = [1];\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                theProduct[0] *= matrix[i][j];\n            }\n        }\n    } else if (dimension === 0) {\n        theProduct = new Array(cols);\n        for (j = 0; j < cols; j++) {\n            theProduct[j] = 1;\n            for (i = 0; i < rows; i++) {\n                theProduct[j] *= matrix[i][j];\n            }\n        }\n    } else if (dimension === 1) {\n        theProduct = new Array(rows);\n        for (j = 0; j < rows; j++) {\n            theProduct[j] = 1;\n            for (i = 0; i < cols; i++) {\n                theProduct[j] *= matrix[j][i];\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n    return theProduct;\n};\n\nexports.standardDeviation = function standardDeviation(matrix, means, unbiased) {\n    var vari = exports.variance(matrix, means, unbiased), l = vari.length;\n    for (var i = 0; i < l; i++) {\n        vari[i] = Math.sqrt(vari[i]);\n    }\n    return vari;\n};\n\nexports.variance = function variance(matrix, means, unbiased) {\n    if (typeof (unbiased) === 'undefined') {\n        unbiased = true;\n    }\n    means = means || exports.mean(matrix);\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length;\n    var vari = new Array(cols);\n\n    for (var j = 0; j < cols; j++) {\n        var sum1 = 0, sum2 = 0, x = 0;\n        for (var i = 0; i < rows; i++) {\n            x = matrix[i][j] - means[j];\n            sum1 += x;\n            sum2 += x * x;\n        }\n        if (unbiased) {\n            vari[j] = (sum2 - ((sum1 * sum1) / rows)) / (rows - 1);\n        } else {\n            vari[j] = (sum2 - ((sum1 * sum1) / rows)) / rows;\n        }\n    }\n    return vari;\n};\n\nexports.median = function median(matrix) {\n    var rows = matrix.length, cols = matrix[0].length;\n    var medians = new Array(cols);\n\n    for (var i = 0; i < cols; i++) {\n        var data = new Array(rows);\n        for (var j = 0; j < rows; j++) {\n            data[j] = matrix[j][i];\n        }\n        data.sort(compareNumbers);\n        var N = data.length;\n        if (N % 2 === 0) {\n            medians[i] = (data[N / 2] + data[(N / 2) - 1]) * 0.5;\n        } else {\n            medians[i] = data[Math.floor(N / 2)];\n        }\n    }\n    return medians;\n};\n\nexports.mode = function mode(matrix) {\n    var rows = matrix.length,\n        cols = matrix[0].length,\n        modes = new Array(cols),\n        i, j;\n    for (i = 0; i < cols; i++) {\n        var itemCount = new Array(rows);\n        for (var k = 0; k < rows; k++) {\n            itemCount[k] = 0;\n        }\n        var itemArray = new Array(rows);\n        var count = 0;\n\n        for (j = 0; j < rows; j++) {\n            var index = itemArray.indexOf(matrix[j][i]);\n            if (index >= 0) {\n                itemCount[index]++;\n            } else {\n                itemArray[count] = matrix[j][i];\n                itemCount[count] = 1;\n                count++;\n            }\n        }\n\n        var maxValue = 0, maxIndex = 0;\n        for (j = 0; j < count; j++) {\n            if (itemCount[j] > maxValue) {\n                maxValue = itemCount[j];\n                maxIndex = j;\n            }\n        }\n\n        modes[i] = itemArray[maxIndex];\n    }\n    return modes;\n};\n\nexports.skewness = function skewness(matrix, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var means = exports.mean(matrix);\n    var n = matrix.length, l = means.length;\n    var skew = new Array(l);\n\n    for (var j = 0; j < l; j++) {\n        var s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var dev = matrix[i][j] - means[j];\n            s2 += dev * dev;\n            s3 += dev * dev * dev;\n        }\n\n        var m2 = s2 / n;\n        var m3 = s3 / n;\n        var g = m3 / Math.pow(m2, 3 / 2);\n\n        if (unbiased) {\n            var a = Math.sqrt(n * (n - 1));\n            var b = n - 2;\n            skew[j] = (a / b) * g;\n        } else {\n            skew[j] = g;\n        }\n    }\n    return skew;\n};\n\nexports.kurtosis = function kurtosis(matrix, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var means = exports.mean(matrix);\n    var n = matrix.length, m = matrix[0].length;\n    var kurt = new Array(m);\n\n    for (var j = 0; j < m; j++) {\n        var s2 = 0, s4 = 0;\n        for (var i = 0; i < n; i++) {\n            var dev = matrix[i][j] - means[j];\n            s2 += dev * dev;\n            s4 += dev * dev * dev * dev;\n        }\n        var m2 = s2 / n;\n        var m4 = s4 / n;\n\n        if (unbiased) {\n            var v = s2 / (n - 1);\n            var a = (n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3));\n            var b = s4 / (v * v);\n            var c = ((n - 1) * (n - 1)) / ((n - 2) * (n - 3));\n            kurt[j] = a * b - 3 * c;\n        } else {\n            kurt[j] = m4 / (m2 * m2) - 3;\n        }\n    }\n    return kurt;\n};\n\nexports.standardError = function standardError(matrix) {\n    var samples = matrix.length;\n    var standardDeviations = exports.standardDeviation(matrix);\n    var l = standardDeviations.length;\n    var standardErrors = new Array(l);\n    var sqrtN = Math.sqrt(samples);\n\n    for (var i = 0; i < l; i++) {\n        standardErrors[i] = standardDeviations[i] / sqrtN;\n    }\n    return standardErrors;\n};\n\nexports.covariance = function covariance(matrix, dimension) {\n    return exports.scatter(matrix, undefined, dimension);\n};\n\nexports.scatter = function scatter(matrix, divisor, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    if (typeof (divisor) === 'undefined') {\n        if (dimension === 0) {\n            divisor = matrix.length - 1;\n        } else if (dimension === 1) {\n            divisor = matrix[0].length - 1;\n        }\n    }\n    var means = exports.mean(matrix, dimension);\n    var rows = matrix.length;\n    if (rows === 0) {\n        return [[]];\n    }\n    var cols = matrix[0].length,\n        cov, i, j, s, k;\n\n    if (dimension === 0) {\n        cov = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            cov[i] = new Array(cols);\n        }\n        for (i = 0; i < cols; i++) {\n            for (j = i; j < cols; j++) {\n                s = 0;\n                for (k = 0; k < rows; k++) {\n                    s += (matrix[k][j] - means[j]) * (matrix[k][i] - means[i]);\n                }\n                s /= divisor;\n                cov[i][j] = s;\n                cov[j][i] = s;\n            }\n        }\n    } else if (dimension === 1) {\n        cov = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            cov[i] = new Array(rows);\n        }\n        for (i = 0; i < rows; i++) {\n            for (j = i; j < rows; j++) {\n                s = 0;\n                for (k = 0; k < cols; k++) {\n                    s += (matrix[j][k] - means[j]) * (matrix[i][k] - means[i]);\n                }\n                s /= divisor;\n                cov[i][j] = s;\n                cov[j][i] = s;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    return cov;\n};\n\nexports.correlation = function correlation(matrix) {\n    var means = exports.mean(matrix),\n        standardDeviations = exports.standardDeviation(matrix, true, means),\n        scores = exports.zScores(matrix, means, standardDeviations),\n        rows = matrix.length,\n        cols = matrix[0].length,\n        i, j;\n\n    var cor = new Array(cols);\n    for (i = 0; i < cols; i++) {\n        cor[i] = new Array(cols);\n    }\n    for (i = 0; i < cols; i++) {\n        for (j = i; j < cols; j++) {\n            var c = 0;\n            for (var k = 0, l = scores.length; k < l; k++) {\n                c += scores[k][j] * scores[k][i];\n            }\n            c /= rows - 1;\n            cor[i][j] = c;\n            cor[j][i] = c;\n        }\n    }\n    return cor;\n};\n\nexports.zScores = function zScores(matrix, means, standardDeviations) {\n    means = means || exports.mean(matrix);\n    if (typeof (standardDeviations) === 'undefined') standardDeviations = exports.standardDeviation(matrix, true, means);\n    return exports.standardize(exports.center(matrix, means, false), standardDeviations, true);\n};\n\nexports.center = function center(matrix, means, inPlace) {\n    means = means || exports.mean(matrix);\n    var result = matrix,\n        l = matrix.length,\n        i, j, jj;\n\n    if (!inPlace) {\n        result = new Array(l);\n        for (i = 0; i < l; i++) {\n            result[i] = new Array(matrix[i].length);\n        }\n    }\n\n    for (i = 0; i < l; i++) {\n        var row = result[i];\n        for (j = 0, jj = row.length; j < jj; j++) {\n            row[j] = matrix[i][j] - means[j];\n        }\n    }\n    return result;\n};\n\nexports.standardize = function standardize(matrix, standardDeviations, inPlace) {\n    if (typeof (standardDeviations) === 'undefined') standardDeviations = exports.standardDeviation(matrix);\n    var result = matrix,\n        l = matrix.length,\n        i, j, jj;\n\n    if (!inPlace) {\n        result = new Array(l);\n        for (i = 0; i < l; i++) {\n            result[i] = new Array(matrix[i].length);\n        }\n    }\n\n    for (i = 0; i < l; i++) {\n        var resultRow = result[i];\n        var sourceRow = matrix[i];\n        for (j = 0, jj = resultRow.length; j < jj; j++) {\n            if (standardDeviations[j] !== 0 && !isNaN(standardDeviations[j])) {\n                resultRow[j] = sourceRow[j] / standardDeviations[j];\n            }\n        }\n    }\n    return result;\n};\n\nexports.weightedVariance = function weightedVariance(matrix, weights) {\n    var means = exports.mean(matrix);\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length;\n    var vari = new Array(cols);\n\n    for (var j = 0; j < cols; j++) {\n        var sum = 0;\n        var a = 0, b = 0;\n\n        for (var i = 0; i < rows; i++) {\n            var z = matrix[i][j] - means[j];\n            var w = weights[i];\n\n            sum += w * (z * z);\n            b += w;\n            a += w * w;\n        }\n\n        vari[j] = sum * (b / (b * b - a));\n    }\n\n    return vari;\n};\n\nexports.weightedMean = function weightedMean(matrix, weights, dimension) {\n    if (typeof (dimension) === 'undefined') {\n        dimension = 0;\n    }\n    var rows = matrix.length;\n    if (rows === 0) return [];\n    var cols = matrix[0].length,\n        means, i, ii, j, w, row;\n\n    if (dimension === 0) {\n        means = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            means[i] = 0;\n        }\n        for (i = 0; i < rows; i++) {\n            row = matrix[i];\n            w = weights[i];\n            for (j = 0; j < cols; j++) {\n                means[j] += row[j] * w;\n            }\n        }\n    } else if (dimension === 1) {\n        means = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            means[i] = 0;\n        }\n        for (j = 0; j < rows; j++) {\n            row = matrix[j];\n            w = weights[j];\n            for (i = 0; i < cols; i++) {\n                means[j] += row[i] * w;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    var weightSum = arrayStat.sum(weights);\n    if (weightSum !== 0) {\n        for (i = 0, ii = means.length; i < ii; i++) {\n            means[i] /= weightSum;\n        }\n    }\n    return means;\n};\n\nexports.weightedCovariance = function weightedCovariance(matrix, weights, means, dimension) {\n    dimension = dimension || 0;\n    means = means || exports.weightedMean(matrix, weights, dimension);\n    var s1 = 0, s2 = 0;\n    for (var i = 0, ii = weights.length; i < ii; i++) {\n        s1 += weights[i];\n        s2 += weights[i] * weights[i];\n    }\n    var factor = s1 / (s1 * s1 - s2);\n    return exports.weightedScatter(matrix, weights, means, factor, dimension);\n};\n\nexports.weightedScatter = function weightedScatter(matrix, weights, means, factor, dimension) {\n    dimension = dimension || 0;\n    means = means || exports.weightedMean(matrix, weights, dimension);\n    if (typeof (factor) === 'undefined') {\n        factor = 1;\n    }\n    var rows = matrix.length;\n    if (rows === 0) {\n        return [[]];\n    }\n    var cols = matrix[0].length,\n        cov, i, j, k, s;\n\n    if (dimension === 0) {\n        cov = new Array(cols);\n        for (i = 0; i < cols; i++) {\n            cov[i] = new Array(cols);\n        }\n        for (i = 0; i < cols; i++) {\n            for (j = i; j < cols; j++) {\n                s = 0;\n                for (k = 0; k < rows; k++) {\n                    s += weights[k] * (matrix[k][j] - means[j]) * (matrix[k][i] - means[i]);\n                }\n                cov[i][j] = s * factor;\n                cov[j][i] = s * factor;\n            }\n        }\n    } else if (dimension === 1) {\n        cov = new Array(rows);\n        for (i = 0; i < rows; i++) {\n            cov[i] = new Array(rows);\n        }\n        for (i = 0; i < rows; i++) {\n            for (j = i; j < rows; j++) {\n                s = 0;\n                for (k = 0; k < cols; k++) {\n                    s += weights[k] * (matrix[j][k] - means[j]) * (matrix[i][k] - means[i]);\n                }\n                cov[i][j] = s * factor;\n                cov[j][i] = s * factor;\n            }\n        }\n    } else {\n        throw new Error('Invalid dimension');\n    }\n\n    return cov;\n};\n"],"sourceRoot":""}